{"title":"Wolfpack World Cup Predictor","markdown":{"yaml":{"title":"Wolfpack World Cup Predictor","image":"wc_logo.png","about":{"template":"trestles","image-shape":"rounded","image-width":"15em"}},"headingText":"players names","containsRefs":false,"markdown":"\n\n```{r include = FALSE}\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(kableExtra)\nlibrary(rvest)\nlibrary(stringi)\nlibrary(stringr)\nnames <- c(\n  \"Drew\", \"Bob\", \"Curran\", \"Sully\", \"Ray\", \"Shaw\",\n  \"Coady\", \"Pa\", \"Hanley\"\n)\n# standings ---------------------------------------------------------------\nstandings <- data.frame(\"Name\" = names)\n# group results -----------------------------------------------------------\ngroup_results <- read.csv(\"files/group-results.csv\")\n# scrape results ----------------------------------------------------------\nfixtures_results <- read.csv(\"files/fixtures-results.csv\")\nresults <- fixtures_results[, c(5, 6, 8, 9)]\nurl_result <- c(\"https://www.soccerbase.com/matches/results.sd\")\nresult <- read_html(url_result)\nscores <- result %>%\n  html_nodes(\".score\") %>%\n  html_text()\nteams <- result %>%\n  html_nodes(\".team\") %>%\n  html_text()\nHome <- teams[seq(1, length(teams) - 1, by = 2)]\nAway <- teams[seq(2, length(teams), by = 2)]\nHome.score <- sapply(scores, \\(x) str_sub(x, start = 1, end = 1))\nAway.score <- sapply(scores, \\(x) str_sub(x, start = -1, end = -1))\nscraped <- data.frame(Home, Away, Home.score, Away.score)\nscraped$Home.score <- ifelse(scraped$Home.score == \"v\", NA, scraped$Home.score)\nscraped$Away.score <- ifelse(scraped$Away.score == \"v\", NA, scraped$Away.score)\nscraped$Home[scraped$Home == \"South Korea\"] <- \"Korea Republic\"\nscraped$Away[scraped$Away == \"South Korea\"] <- \"Korea Republic\"\nresults <- left_join(results, scraped,\n  by = c(\"Home.Team\" = \"Home\", \"Away.Team\" = \"Away\")\n)\nresults[is.na(results$Home.Score) & is.na(results$Away.Score) &\n  !is.na(results$Home.score) & !is.na(results$Away.score), c(3, 4)] <-\n  results[is.na(results$Home.Score) & is.na(results$Away.Score) &\n    !is.na(results$Home.score) & !is.na(results$Away.score), c(5, 6)]\nfixtures_results$Home.Score <- results$Home.Score\nfixtures_results$Away.Score <- results$Away.Score\nwrite.csv(fixtures_results, \"files/fixtures-results.csv\", row.names = FALSE)\n# fixtures results ---------------------------------------------------------\nfixtures_results <- read.csv(\"files/fixtures-results.csv\")\nresults <- fixtures_results[!is.na(fixtures_results$Home.Score), c(5, 6, 8, 9)]\nresults$Result <- ifelse(\n  results$Home.Score > results$Away.Score + 1, \"H2\",\n  ifelse(results$Home.Score + 1 < results$Away.Score, \"A2\",\n    ifelse(results$Home.Score > results$Away.Score, \"H\",\n      ifelse(results$Home.Score < results$Away.Score, \"A\",\n        ifelse(results$Home.Score == results$Away.Score, \"D\",\n          \"NA\"\n        )\n      )\n    )\n  )\n)\nresults <- results[, c(1, 2, 5)]\n# group selection ----------------------------------------------\nfor (name in names) {\n  my_data <- read_excel(\"files/Wolfpack World Cup Predictor 2022.xlsm\",\n    sheet = name, col_names = FALSE\n  )\n  # group match points ------------------------------------------------------\n  group_selections <- my_data[, 1:8]\n  remove_ind <- c(1:2, sapply(1:7, \\(x) (9 * x):((9 * x) + 2)), 72:73)\n  group_selections <- group_selections[-remove_ind, ]\n  group_selections[, 9] <- ifelse(\n    !is.na(group_selections[, 2]), \"H2\",\n    ifelse(!is.na(group_selections[, 3]), \"H\",\n      ifelse(!is.na(group_selections[, 4]), \"D\",\n        ifelse(!is.na(group_selections[, 5]), \"A\",\n          ifelse(!is.na(group_selections[, 6]), \"A2\",\n            \"NA\"\n          )\n        )\n      )\n    )\n  )\n  group_selections <- group_selections[, c(1, 7, 9)]\n  colnames(group_selections) <- c(colnames(results)[1:2], \"Prediction\")\n  group_selections$Home.Team[group_selections$Home.Team\n  == \"Netrherlands\"] <- \"Netherlands\"\n  group_selections$Home.Team[group_selections$Home.Team\n  == \"Crotia\"] <- \"Croatia\"\n  group_selections$Home.Team[group_selections$Home.Team\n  == \"IR Iran\"] <- \"Iran\"\n  group_selections$Home.Team[group_selections$Home.Team\n  == \"Tunsia\"] <- \"Tunisia\"\n  group_selections$Home.Team[group_selections$Home.Team\n  == \"Switzgerald\"] <- \"Switzerland\"\n  group_selections$Away.Team[group_selections$Away.Team\n  == \"Netrherlands\"] <- \"Netherlands\"\n  group_selections$Away.Team[group_selections$Away.Team\n  == \"Crotia\"] <- \"Croatia\"\n  group_selections$Away.Team[group_selections$Away.Team\n  == \"IR Iran\"] <- \"Iran\"\n  group_selections$Away.Team[group_selections$Away.Team\n  == \"Tunsia\"] <- \"Tunisia\"\n  group_selections$Away.Team[group_selections$Away.Team\n  == \"Switzgerald\"] <- \"Switzerland\"\n  df <- left_join(group_selections, results,\n    by = c(\"Home.Team\", \"Away.Team\")\n  )\n  df$Points <- ifelse(\n    (df$Prediction == df$Result) & (df$Prediction == \"H2\" | df$Prediction == \"A2\"), 2,\n    ifelse(df$Prediction == df$Result, 1,\n      ifelse((df$Prediction == \"H\" & df$Result == \"H2\") |\n        (df$Prediction == \"A\" & df$Result == \"A2\"), 1,\n      ifelse((df$Prediction == \"H2\" & df$Result == \"H\") |\n        (df$Prediction == \"A2\" & df$Result == \"A\"), 0,\n      ifelse(df$Prediction == \"H2\" | df$Prediction == \"A2\", -1, 0)\n      )\n      )\n    )\n  )\n  df$MP <- ifelse(df$Prediction == df$Result, 1,\n    ifelse((df$Prediction == \"H\" & df$Result == \"H2\") |\n      (df$Prediction == \"A\" & df$Result == \"A2\"), 1,\n    ifelse((df$Prediction == \"H2\" & df$Result == \"H\") |\n      (df$Prediction == \"A2\" & df$Result == \"A\"), 1, 0)\n    )\n  )\n  df$BP <- ifelse((df$Prediction == df$Result) &\n    (df$Prediction == \"H2\" | df$Prediction == \"A2\"), 1, 0)\n  df$DP <- ifelse(!(df$Prediction == df$Result) &\n    (df$Prediction == \"H2\" | df$Prediction == \"A2\"), -1, 0)\n  assign(name, df)\n  # group rank points -------------------------------------------------------\n  group_standings <- my_data[-c(\n    1:2, 7:11, 16:20, 25:29, 34:38, 43:47,\n    52:56, 61:65, 70:73\n  ), 9:10]\n  colnames(group_standings) <- c(\"Position\", \"Team\")\n  group_standings$Group <- rep(c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\"),\n    each = 4\n  )\n  group_standings$Team[group_standings$Team\n  == \"Crotia\"] <- \"Croatia\"\n  group_standings$Team[group_standings$Team\n  == \"IR Iran\"] <- \"Iran\"\n  group_standings$Team[group_standings$Team\n  == \"Cost Rica\"] <- \"Costa Rica\"\n  colnames(group_results)[1] <- \"Result\"\n  df_group <- left_join(group_standings, group_results,\n    by = c(\"Team\", \"Group\")\n  )\n  df_group$score <- ifelse(df_group$Position == df_group$Result, 1, 0)\n  df_group_points <- data.frame(\n    Group = c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\"),\n    Points = NA\n  )\n  df_group_points$Points <- sapply(df_group_points$Group, \\(x)\n  as.numeric(sum(df_group$score[df_group$Group == x]) == 4))\n  # round of 16 points ------------------------------------------------------\n  R16 <- my_data[c(3, 8, 13, 18, 23, 28, 33, 38), c(13, 14)]\n  R16$Prediction <- ifelse(is.na(my_data[c(4, 9, 14, 19, 24, 29, 34, 39), 13]),\n    \"Away Win\", \"Home Win\"\n  )\n  R16$Game <- c(49:56)\n  R16$Stage <- rep(\"R16\", 8)\n  QF <- my_data[c(5, 15, 25, 35), c(17, 18)]\n  QF$Prediction <- ifelse(is.na(my_data[c(6, 16, 26, 36), 17]),\n    \"Away Win\", \"Home Win\"\n  )\n  QF$Game <- c(57:60)\n  QF$Stage <- rep(\"QF\", 4)\n  SF <- my_data[c(10, 30), c(21, 22)]\n  SF$Prediction <- ifelse(is.na(my_data[c(11, 31), 21]),\n    \"Away Win\", \"Home Win\"\n  )\n  SF$Game <- c(61, 62)\n  SF$Stage <- rep(\"SF\", 2)\n  F_TP <- my_data[c(15, 25), c(25, 26)]\n  F_TP$Prediction <- ifelse(is.na(my_data[c(16, 26), 25]),\n    \"Away Win\", \"Home Win\"\n  )\n  F_TP$Game <- c(64, 63)\n  F_TP$Stage <- c(\"F\", \"TP\")\n  colnames(R16) <- colnames(QF) <- colnames(SF) <- colnames(F_TP) <-\n    c(\"Home Team\", \"Away Team\", \"Prediction\", \"order\", \"Stage\")\n  knockouts <- rbind(R16, QF, SF, F_TP)\n  knockouts$`Home Team`[knockouts$`Home Team`\n  == \"Netrherlands\"] <- \"Netherlands\"\n  knockouts$`Home Team`[knockouts$`Home Team`\n  == \"Crotia\"] <- \"Croatia\"\n  knockouts$`Home Team`[knockouts$`Home Team`\n  == \"IR Iran\"] <- \"Iran\"\n  knockouts$`Home Team`[knockouts$`Home Team`\n  == \"Tunsia\"] <- \"Tunisia\"\n  knockouts$`Home Team`[knockouts$`Home Team`\n  == \"Switzgerald\"] <- \"Switzerland\"\n  knockouts$`Away Team`[knockouts$`Away Team`\n  == \"Netrherlands\"] <- \"Netherlands\"\n  knockouts$`Away Team`[knockouts$`Away Team`\n  == \"Crotia\"] <- \"Croatia\"\n  knockouts$`Away Team`[knockouts$`Away Team`\n  == \"IR Iran\"] <- \"Iran\"\n  knockouts$`Away Team`[knockouts$`Away Team`\n  == \"Tunsia\"] <- \"Tunisia\"\n  knockouts$`Away Team`[knockouts$`Away Team`\n  == \"Switzgerald\"] <- \"Switzerland\"\n  R16$`Home Team`[R16$`Home Team`\n  == \"Netrherlands\"] <- \"Netherlands\"\n  R16$`Home Team`[R16$`Home Team`\n  == \"Crotia\"] <- \"Croatia\"\n  R16$`Home Team`[R16$`Home Team`\n  == \"IR Iran\"] <- \"Iran\"\n  R16$`Home Team`[R16$`Home Team`\n  == \"Tunsia\"] <- \"Tunisia\"\n  R16$`Home Team`[R16$`Home Team`\n  == \"Switzgerald\"] <- \"Switzerland\"\n  R16$`Away Team`[R16$`Away Team`\n  == \"Netrherlands\"] <- \"Netherlands\"\n  R16$`Away Team`[R16$`Away Team`\n  == \"Crotia\"] <- \"Croatia\"\n  R16$`Away Team`[R16$`Away Team`\n  == \"IR Iran\"] <- \"Iran\"\n  R16$`Away Team`[R16$`Away Team`\n  == \"Tunsia\"] <- \"Tunisia\"\n  R16$`Away Team`[R16$`Away Team`\n  == \"Switzgerald\"] <- \"Switzerland\"\n  knockouts$Result <- NA\n  knockouts$Points <- NA\n  knockouts <- knockouts[order(knockouts$order), c(1:3, 6, 4, 7)]\n  R16_results <- read.csv(\"files/R16_results.csv\")\n  R16_results$`Home.Team` <- group_results$Team[c(1, 9, 5, 13, 17, 25, 21, 29)]\n  R16_results$`Away.Team` <- group_results$Team[c(6, 14, 2, 10, 22, 30, 18, 26)]\n  R16_results <- left_join(R16_results, scraped,\n    by = c(\"Home.Team\" = \"Home\", \"Away.Team\" = \"Away\")\n  )\n  R16_results$Result <- ifelse(!is.na(R16_results$Result), R16_results$Result,\n    ifelse(R16_results$Home.score > R16_results$Away.score,\n      \"Home Win\",\n      ifelse(R16_results$Home.score < R16_results$Away.score,\n        \"Away Win\", \"Draw\"\n      )\n    )\n  )\n  R16_results <- R16_results[, c(1:4)]\n  write.csv(R16_results, \"files/R16_results.csv\", row.names = FALSE)\n  R16$Points <- ifelse(is.na(as.numeric(R16$`Home Team` == R16_results$`Home.Team`)),\n    0, as.numeric(R16$`Home Team` == R16_results$`Home.Team`)\n  ) +\n    ifelse(is.na(as.numeric(R16$`Away Team` == R16_results$`Away.Team`)),\n      0, as.numeric(R16$`Away Team` == R16_results$`Away.Team`)\n    ) +\n    ifelse(is.na(as.numeric(R16$`Home Team` %in% c(\n      R16_results$`Home.Team`,\n      R16_results$`Away.Team`\n    ))),\n    0, as.numeric(R16$`Home Team` %in% c(\n      R16_results$`Home.Team`,\n      R16_results$`Away.Team`\n    ))\n    ) +\n    ifelse(is.na(as.numeric(R16$`Away Team` %in% c(\n      R16_results$`Home.Team`,\n      R16_results$`Away.Team`\n    ))),\n    0, as.numeric(R16$`Away Team` %in% c(\n      R16_results$`Home.Team`,\n      R16_results$`Away.Team`\n    ))\n    ) +\n    ifelse(is.na(as.numeric(R16$Prediction == R16_results$Result)), 0,\n      2 * as.numeric(R16$Prediction == R16_results$Result)\n    )\n  R16_points <- sum(R16$`Home Team` == R16_results$`Home.Team`, na.rm = TRUE) +\n    sum(R16$`Away Team` == R16_results$`Away.Team`, na.rm = TRUE) +\n    sum(R16$`Home Team` %in% c(\n      R16_results$`Home.Team`,\n      R16_results$`Away.Team`\n    ), na.rm = TRUE) +\n    sum(R16$`Away Team` %in% c(\n      R16_results$`Home.Team`,\n      R16_results$`Away.Team`\n    ), na.rm = TRUE) +\n    2 * sum(R16$Prediction == R16_results$Result, na.rm = TRUE)\n  # round of 16 points ------------------------------------------------------\n  R16 <- my_data[c(3, 8, 13, 18, 23, 28, 33, 38), c(13, 14)]\n  \n  R16$Prediction <- ifelse(is.na(my_data[c(4, 9, 14, 19, 24, 29, 34, 39), 13]),\n                           \"Away Win\", \"Home Win\"\n  )\n  \n  R16$Game <- c(49:56)\n  \n  R16$Stage <- rep(\"R16\", 8)\n  \n  QF <- my_data[c(5, 15, 25, 35), c(17, 18)]\n  \n  QF$Prediction <- ifelse(is.na(my_data[c(6, 16, 26, 36), 17]),\n                          \"Away Win\", \"Home Win\"\n  )\n  \n  QF$Game <- c(57:60)\n  QF$Stage <- rep(\"QF\", 4)\n  SF <- my_data[c(10, 30), c(21, 22)]\n  SF$Prediction <- ifelse(is.na(my_data[c(11, 31), 21]),\n                          \"Away Win\", \"Home Win\"\n  )\n  SF$Game <- c(61, 62)\n  SF$Stage <- rep(\"SF\", 2)\n  F_TP <- my_data[c(15, 25), c(25, 26)]\n  F_TP$Prediction <- ifelse(is.na(my_data[c(16, 26), 25]),\n                            \"Away Win\", \"Home Win\"\n  )\n  F_TP$Game <- c(64, 63)\n  F_TP$Stage <- c(\"F\", \"TP\")\n  F_TP_full <- F_TP\n  colnames(R16) <- colnames(QF) <- colnames(SF) <- colnames(F_TP) <-\n    c(\"Home Team\", \"Away Team\", \"Prediction\", \"order\", \"Stage\")\n  knockouts <- rbind(R16, QF, SF, F_TP)\n  knockouts$`Home Team`[knockouts$`Home Team`\n                        == \"Netrherlands\"] <- \"Netherlands\"\n  knockouts$`Home Team`[knockouts$`Home Team`\n                        == \"Crotia\"] <- \"Croatia\"\n  knockouts$`Home Team`[knockouts$`Home Team`\n                        == \"IR Iran\"] <- \"Iran\"\n  knockouts$`Home Team`[knockouts$`Home Team`\n                        == \"Tunsia\"] <- \"Tunisia\"\n  knockouts$`Home Team`[knockouts$`Home Team`\n                        == \"Switzgerald\"] <- \"Switzerland\"\n  knockouts$`Away Team`[knockouts$`Away Team`\n                        == \"Netrherlands\"] <- \"Netherlands\"\n  knockouts$`Away Team`[knockouts$`Away Team`\n                        == \"Crotia\"] <- \"Croatia\"\n  knockouts$`Away Team`[knockouts$`Away Team`\n                        == \"IR Iran\"] <- \"Iran\"\n  knockouts$`Away Team`[knockouts$`Away Team`\n                        == \"Tunsia\"] <- \"Tunisia\"\n  knockouts$`Away Team`[knockouts$`Away Team`\n                        == \"Switzgerald\"] <- \"Switzerland\"\n  R16$`Home Team`[R16$`Home Team`\n                  == \"Netrherlands\"] <- \"Netherlands\"\n  R16$`Home Team`[R16$`Home Team`\n                  == \"Crotia\"] <- \"Croatia\"\n  R16$`Home Team`[R16$`Home Team`\n                  == \"IR Iran\"] <- \"Iran\"\n  R16$`Home Team`[R16$`Home Team`\n                  == \"Tunsia\"] <- \"Tunisia\"\n  R16$`Home Team`[R16$`Home Team`\n                  == \"Switzgerald\"] <- \"Switzerland\"\n  R16$`Away Team`[R16$`Away Team`\n                  == \"Netrherlands\"] <- \"Netherlands\"\n  R16$`Away Team`[R16$`Away Team`\n                  == \"Crotia\"] <- \"Croatia\"\n  R16$`Away Team`[R16$`Away Team`\n                  == \"IR Iran\"] <- \"Iran\"\n  R16$`Away Team`[R16$`Away Team`\n                  == \"Tunsia\"] <- \"Tunisia\"\n  R16$`Away Team`[R16$`Away Team`\n                  == \"Switzgerald\"] <- \"Switzerland\"\n  \n  knockouts$Result <- NA\n  knockouts$Points <- NA\n  knockouts <- knockouts[order(knockouts$order), c(1:3, 6, 4, 7)]\n  \n  R16_results <- read.csv(\"files/R16_results.csv\")\n  R16_results$`Home.Team` <- group_results$Team[c(1, 9, 5, 13, 17, 25, 21, 29)]\n  R16_results$`Away.Team` <- group_results$Team[c(6, 14, 2, 10, 22, 30, 18, 26)]\n  R16_results <- left_join(R16_results, scraped,\n                           by = c(\"Home.Team\" = \"Home\", \"Away.Team\" = \"Away\")\n  )\n  R16_results$Result <- ifelse(!is.na(R16_results$Result), R16_results$Result,\n                               ifelse(R16_results$Home.score > R16_results$Away.score,\n                                      \"Home Win\",\n                                      ifelse(R16_results$Home.score < R16_results$Away.score,\n                                             \"Away Win\", \"Draw\"\n                                      )\n                               )\n  )\n  R16_results <- R16_results[, c(1:4)]\n  write.csv(R16_results, \"files/R16_results.csv\", row.names = FALSE)\n  R16$Points <- ifelse(is.na(as.numeric(R16$`Home Team` == R16_results$`Home.Team`)),\n                       0, as.numeric(R16$`Home Team` == R16_results$`Home.Team`)\n  ) +\n    ifelse(is.na(as.numeric(R16$`Away Team` == R16_results$`Away.Team`)),\n           0, as.numeric(R16$`Away Team` == R16_results$`Away.Team`)\n    ) +\n    ifelse(is.na(as.numeric(R16$`Home Team` %in% c(\n      R16_results$`Home.Team`,\n      R16_results$`Away.Team`\n    ))),\n    0, as.numeric(R16$`Home Team` %in% c(\n      R16_results$`Home.Team`,\n      R16_results$`Away.Team`\n    ))\n    ) +\n    ifelse(is.na(as.numeric(R16$`Away Team` %in% c(\n      R16_results$`Home.Team`,\n      R16_results$`Away.Team`\n    ))),\n    0, as.numeric(R16$`Away Team` %in% c(\n      R16_results$`Home.Team`,\n      R16_results$`Away.Team`\n    ))\n    ) +\n    ifelse(is.na(as.numeric(R16$Prediction == R16_results$Result)), 0,\n           2 * as.numeric(R16$Prediction == R16_results$Result)\n    )\n  R16_points <- sum(R16$`Home Team` == R16_results$`Home.Team`, na.rm = TRUE) +\n    sum(R16$`Away Team` == R16_results$`Away.Team`, na.rm = TRUE) +\n    sum(R16$`Home Team` %in% c(\n      R16_results$`Home.Team`,\n      R16_results$`Away.Team`\n    ), na.rm = TRUE) +\n    sum(R16$`Away Team` %in% c(\n      R16_results$`Home.Team`,\n      R16_results$`Away.Team`\n    ), na.rm = TRUE) +\n    2 * sum(R16$Prediction == R16_results$Result, na.rm = TRUE)\n  # QF Points ---------------------------------------------------------------\n  \n  QF_results <- read.csv(\"files/QF_results.csv\")\n  \n  QF_results <- left_join(QF_results, scraped,\n                          by = c(\"Home.Team\" = \"Home\", \"Away.Team\" = \"Away\")\n  )\n  QF_results$Result <- ifelse(!is.na(QF_results$Result), QF_results$Result,\n    ifelse(QF_results$Home.score > QF_results$Away.score,\n                              \"Home Win\",\n                              ifelse(QF_results$Home.score < QF_results$Away.score,\n                                     \"Away Win\", \"Draw\"\n                              )\n  ))\n  QF_results <- QF_results[, c(3, 4, 2, 1)]\n  \n  write.csv(QF_results, \"files/QF_results.csv\", row.names = FALSE)\n  \n  \n  QF$Points <- ifelse(is.na(as.numeric(QF$`Home Team` == QF_results$`Home.Team`)),\n                      0, 2 * as.numeric(QF$`Home Team` == QF_results$`Home.Team`)\n  ) +\n    ifelse(is.na(as.numeric(QF$`Away Team` == QF_results$`Away.Team`)),\n           0, 2 * as.numeric(QF$`Away Team` == QF_results$`Away.Team`)\n    ) +\n    ifelse(is.na(as.numeric(QF$`Home Team` %in% c(\n      QF_results$`Home.Team`,\n      QF_results$`Away.Team`\n    ))),\n    0, 2 * as.numeric(QF$`Home Team` %in% c(\n      QF_results$`Home.Team`,\n      QF_results$`Away.Team`\n    ))\n    ) +\n    ifelse(is.na(as.numeric(QF$`Away Team` %in% c(\n      QF_results$`Home.Team`,\n      QF_results$`Away.Team`\n    ))),\n    0, 2 * as.numeric(QF$`Away Team` %in% c(\n      QF_results$`Home.Team`,\n      QF_results$`Away.Team`\n    ))\n    ) +\n    ifelse(is.na(as.numeric(QF$Prediction == QF_results$Result)), 0,\n           4 * as.numeric(QF$Prediction == QF_results$Result)\n    )\n  QF_points <- 2 * sum(QF$`Home Team` == QF_results$`Home.Team`, na.rm = TRUE) +\n    2 * sum(QF$`Away Team` == QF_results$`Away.Team`, na.rm = TRUE) +\n    2 * sum(QF$`Home Team` %in% c(\n      QF_results$`Home.Team`,\n      QF_results$`Away.Team`\n    ), na.rm = TRUE) +\n    2 * sum(QF$`Away Team` %in% c(\n      QF_results$`Home.Team`,\n      QF_results$`Away.Team`\n    ), na.rm = TRUE) +\n    4 * sum(QF$Prediction == QF_results$Result, na.rm = TRUE)\n  \n  \n  # SF Points ---------------------------------------------------------------\n  SF_results <- data.frame(order = c(61:62), Result = NA)\n  SF_results$`Home Team` <- ifelse(QF_results$Result[c(1, 3)] == \"Home Win\",\n                                   QF_results$`Home.Team`[c(1, 3)],\n                                   QF_results$`Away.Team`[c(1, 3)]\n  )\n  SF_results$`Away Team` <- ifelse(QF_results$Result[c(2, 4)] == \"Home Win\",\n                                   QF_results$`Home.Team`[c(2, 4)],\n                                   QF_results$`Away.Team`[c(2, 4)]\n  )\n  \n  SF_results <- read.csv(\"files/SF_results.csv\")\n  \n  colnames(SF_results)[1:2] <- c(\"Away Team\", \"Home Team\")\n  \n  SF_results <- left_join(SF_results, scraped,\n                          by = c(\"Home Team\" = \"Home\", \"Away Team\" = \"Away\")\n  )\n  \n\n  SF_results$Result <- ifelse(!is.na(SF_results$Result), SF_results$Result,\n                              ifelse(SF_results$Home.score > SF_results$Away.score,\n                              \"Home Win\",\n                              ifelse(SF_results$Home.score < SF_results$Away.score,\n                                     \"Away Win\", \"Draw\"\n                              )\n  ))\n  SF_results <- SF_results[, 1:4]\n  \n  write.csv(SF_results, \"files/SF_results.csv\", row.names = FALSE)\n  \n  \n  SF$Points <- ifelse(is.na(as.numeric(SF$`Home Team` == SF_results$`Home Team`)),\n                      0, 4 * as.numeric(SF$`Home Team` == SF_results$`Home Team`)\n  ) +\n    ifelse(is.na(as.numeric(SF$`Away Team` == SF_results$`Away Team`)),\n           0, 4 * as.numeric(SF$`Away Team` == SF_results$`Away Team`)\n    ) +\n    ifelse(is.na(as.numeric(SF$`Home Team` %in% c(\n      SF_results$`Home Team`,\n      SF_results$`Away Team`\n    ))),\n    0, 4 * as.numeric(SF$`Home Team` %in% c(\n      SF_results$`Home Team`,\n      SF_results$`Away Team`\n    ))\n    ) +\n    ifelse(is.na(as.numeric(SF$`Away Team` %in% c(\n      SF_results$`Home Team`,\n      SF_results$`Away Team`\n    ))),\n    0, 4 * as.numeric(SF$`Away Team` %in% c(\n      SF_results$`Home Team`,\n      SF_results$`Away Team`\n    ))\n    ) +\n    ifelse(is.na(as.numeric(SF$Prediction == SF_results$Result)), 0,\n           8 * as.numeric(SF$Prediction == SF_results$Result)\n    )\n  SF_points <- 4 * sum(SF$`Home Team` == SF_results$`Home Team`, na.rm = TRUE) +\n    4 * sum(SF$`Away Team` == SF_results$`Away Team`, na.rm = TRUE) +\n    4 * sum(SF$`Home Team` %in% c(\n      SF_results$`Home Team`,\n      SF_results$`Away Team`\n    ), na.rm = TRUE) +\n    4 * sum(SF$`Away Team` %in% c(\n      SF_results$`Home Team`,\n      SF_results$`Away Team`\n    ), na.rm = TRUE) +\n    8 * sum(SF$Prediction == SF_results$Result, na.rm = TRUE)\n  \n  # F Points ---------------------------------------------------------------\n  F_results <- data.frame(order = c(64), Result = NA)\n  F_results$`Home Team` <- ifelse(SF_results$Result[1] == \"Home Win\",\n                                   SF_results$`Home Team`[c(1)],\n                                   SF_results$`Away Team`[c(1)]\n  )\n  F_results$`Away Team` <- ifelse(SF_results$Result[c(2)] == \"Home Win\",\n                                   SF_results$`Home Team`[c(2)],\n                                   SF_results$`Away Team`[c(2)]\n  )\n  \n  # SF_results <- read.csv(\"files/SF_results.csv\")\n  \n  F_results <- left_join(F_results, scraped,\n                          by = c(\"Home Team\" = \"Home\", \"Away Team\" = \"Away\")\n  )\n  F_results$Result <- ifelse(F_results$Home.score > F_results$Away.score,\n                              \"Home Win\",\n                              ifelse(F_results$Home.score < F_results$Away.score,\n                                     \"Away Win\", \"Draw\"\n                              )\n  )\n  F_results <- F_results[, c(3, 4, 2, 1)]\n  \n  # write.csv(SF_results, \"files/SF_results.csv\", row.names = FALSE)\n  colnames(F_TP_full)[1:2] <- c(\"Home Team\", \"Away Team\")\n  \n  F_TP <- F_TP_full[1, ]\n  \n  F_TP$Points <- ifelse(is.na(as.numeric(F_TP$`Home Team` == F_results$`Home Team`)),\n                      0, 8 * as.numeric(F_TP$`Home Team` == F_results$`Home Team`)\n  ) +\n    ifelse(is.na(as.numeric(F_TP$`Away Team` == F_results$`Away Team`)),\n           0, 8 * as.numeric(F_TP$`Away Team` == F_results$`Away Team`)\n    ) +\n    ifelse(is.na(as.numeric(F_TP$`Home Team` %in% c(\n      F_results$`Home Team`,\n      F_results$`Away Team`\n    ))),\n    0, 8 * as.numeric(F_TP$`Home Team` %in% c(\n      F_results$`Home Team`,\n      F_results$`Away Team`\n    ))\n    ) +\n    ifelse(is.na(as.numeric(F_TP$`Away Team` %in% c(\n      F_results$`Home Team`,\n      F_results$`Away Team`\n    ))),\n    0, 8 * as.numeric(F_TP$`Away Team` %in% c(\n      F_results$`Home Team`,\n      F_results$`Away Team`\n    ))\n    ) +\n    ifelse(is.na(as.numeric(F_TP$Prediction == F_results$Result)), 0,\n           16 * as.numeric(F_TP$Prediction == F_results$Result)\n    )\n  F_TP_points <- 8 * sum(F_TP$`Home Team` == F_results$`Home Team`, na.rm = TRUE) +\n    8 * sum(F_TP$`Away Team` == F_results$`Away Team`, na.rm = TRUE) +\n    8 * sum(F_TP$`Home Team` %in% c(\n      F_results$`Home Team`,\n      F_results$`Away Team`\n    ), na.rm = TRUE) +\n    8 * sum(F_TP$`Away Team` %in% c(\n      F_results$`Home Team`,\n      F_results$`Away Team`\n    ), na.rm = TRUE) +\n    16 * sum(F_TP$Prediction == F_results$Result, na.rm = TRUE)\n  # standings ---------------------------------------------------------------\n  standings$MP[standings$Name == name] <- sum(df$MP, na.rm = TRUE)\n  standings$BP[standings$Name == name] <- sum(df$BP, na.rm = TRUE)\n  standings$DP[standings$Name == name] <- sum(df$DP, na.rm = TRUE)\n  standings$GR[standings$Name == name] <- sum(df_group_points$Points,\n    na.rm = TRUE\n  )\n  standings$R16[standings$Name == name] <- sum(R16$Points, na.rm = TRUE)\n  standings$QF[standings$Name == name] <- sum(QF$Points, na.rm = TRUE)\n  standings$SF[standings$Name == name] <- sum(SF$Points, na.rm = TRUE)\n  standings$Final[standings$Name == name] <- sum(F_TP$Points, na.rm = TRUE)\n}\nstandings$`Total Points` <- apply(standings[, -1], 1, sum)\nstandings <- standings[order(standings$`Total Points`, decreasing = TRUE), ]\n\n```\n\n\n\nLast updated: `r format(Sys.time())`\n\n### Table   \n\n```{r echo=FALSE}\nrow.names(standings) <- NULL\nstandings %>%\n  kbl() %>%\n  kable_styling() %>% \n  footnote(general = \"MP = Match Points; BP = Bonus Points; \n           DP = Deducted Points; GR = Group Ranking Points \\n Descriptions can be found in the Rules tab.\")\n\n```\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"index.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.1.251","page-layout":"full","theme":{"light":"flatly","dark":"darkly"},"mainfont":"Nunito","title":"Wolfpack World Cup Predictor","image":"wc_logo.png","about":{"template":"trestles","image-shape":"rounded","image-width":"15em"}},"extensions":{"book":{"multiFile":true}}}}}